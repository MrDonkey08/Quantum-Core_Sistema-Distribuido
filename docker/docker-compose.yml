services:
  worker1:
    build:
      context: ../rust
      dockerfile: ../docker/Dockerfile
    container_name: worker1
    restart: unless-stopped
    environment:
      - ROLE=coordinator
      # Workers to connect to (comma-separated)
      - WORKERS=worker2:8080,worker3:8080,worker4:8080
    ports:
      - "8080:8080"

  worker2:
    build:
      context: ../rust
      dockerfile: ../docker/Dockerfile
    container_name: worker2
    restart: unless-stopped
    environment:
      - ROLE=worker
      - LISTEN_ADDR=0.0.0.0:8080

  worker3:
    build:
      context: ../rust
      dockerfile: ../docker/Dockerfile
    container_name: worker3
    restart: unless-stopped
    environment:
      - ROLE=worker
      - LISTEN_ADDR=0.0.0.0:8080

  worker4:
    build:
      context: ../rust
      dockerfile: ../docker/Dockerfile
    container_name: worker4
    restart: unless-stopped
    environment:
      - ROLE=worker
      - LISTEN_ADDR=0.0.0.0:8080
